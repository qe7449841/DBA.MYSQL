## MYSQL只读参数read_only 和super_read_only 有什么差别

`read_only` 和 `super_read_only` 是 MYSQL 中的两个重要系统变量，它们用于控制数据库的写操作权限。下面是它们的相同点和不同点的详细对比：

| 特性               | `read_only`                                       | `super_read_only`                                |
| ------------------ | ------------------------------------------------- | ------------------------------------------------ |
| **主要作用**       | 限制非超级用户对数据库的写入操作。                | 限制所有用户（包括超级用户）对数据库的写入操作。 |
| **超级用户权限**   | 超级用户（有 `SUPER` 权限的用户）可以执行写操作。 | 超级用户也不能进行写操作。                       |
| **适用范围**       | 非超级用户。                                      | 所有用户，包括超级用户。                         |
| **影响的操作**     | DML（数据操作语言）和 DDL（数据定义语言）操作。   | DML 和 DDL 操作。                                |
| **启用/禁用方法**  | `SET GLOBAL read_only = ON/OFF;`                  | `SET GLOBAL super_read_only = ON/OFF;`           |
| **默认值**         | OFF                                               | OFF                                              |
| **与复制的关系**   | 通常在从服务器上启用以防止数据修改。              | 常用于保护从服务器，以防止意外的写入操作。       |
| **事务影响**       | 开启后，限制新事务中的写操作。                    | 开启后，限制所有新事务中的写操作。               |
| **影响临时表**     | 不影响对临时表的写操作。                          | 不影响对临时表的写操作。                         |
| **用于数据一致性** | 辅助保持从服务器与主服务器的数据一致性。          | 提供更严格的数据一致性保证。                     |

### 使用场景

- **`read_only`**：
  - 通常用于从服务器（Slave）以防止非超级用户进行写操作。
  - 用于防止特定用户组对数据库进行不必要的修改。

- **`super_read_only`**：
  - 用于确保从服务器的只读状态，避免任何用户进行写操作。
  - 常用于维护期间确保没有用户能在数据库上执行修改操作。

### 示例

#### 设置 `read_only`

```sql
-- 设置 read_only 为 ON，限制非超级用户的写操作
SET GLOBAL read_only = ON;
```

#### 设置 `super_read_only`

```sql
-- 设置 super_read_only 为 ON，限制所有用户的写操作
SET GLOBAL super_read_only = ON;
```

### 总结

- `read_only` 主要用于限制非超级用户，超级用户仍可执行写操作。
- `super_read_only` 是更严格的控制，限制所有用户（包括超级用户）的写操作，适用于需要绝对只读的场合。

这两个变量的使用帮助确保数据库的完整性和一致性，尤其是在主从复制环境中.


## MYSQL清除复制RESET SLAV 和RESET SLAVE ALL 有什么差别

在 MySQL 的主从复制环境中，`RESET SLAVE` 和 `RESET SLAVE ALL` 是用于管理从服务器复制状态的重要命令。它们的功能和影响有所不同，具体如下：

| 特性                    | `RESET SLAVE`                                                 | `RESET SLAVE ALL`                                                 |
|-------------------------|--------------------------------------------------------------|------------------------------------------------------------------|
| **主要作用**            | 清除从服务器的复制状态，但保留主服务器的连接信息。          | 完全清除从服务器的复制状态和主服务器的连接信息。                |
| **影响复制位置**        | 将 `master.info` 文件的内容重置，清除复制位置信息。          | 清除所有复制位置信息和主服务器的连接信息，包括 `master.info` 和 `relay-log.info` 文件。 |
| **影响连接信息**        | 不影响主服务器连接信息，保留主服务器的地址、用户名和密码等。 | 删除主服务器的连接信息。                                         |
| **使用场景**            | 当需要重新启动复制或在不更改主服务器信息的情况下重置复制状态。| 当需要完全重新配置复制环境或者切换到新的主服务器时。              |
| **日志文件处理**        | 不删除 relay logs（中继日志），仅重置复制状态。              | 删除所有 relay logs（中继日志）。                                |
| **安全性**              | 适用于保留连接配置的情况下重置复制。                        | 适用于需要完全重置复制配置的情况下。                              |
| **恢复操作复杂度**      | 易于恢复复制，仅需 START SLAVE。                             | 需要重新配置主服务器的连接信息，可能需要执行 CHANGE MASTER TO。    |
| **使用命令**            | `RESET SLAVE;`                                               | `RESET SLAVE ALL;`                                               |

### 使用场景

- **`RESET SLAVE`**：
  - 当从服务器出现错误且需要重置复制状态时使用，但不希望影响到现有的主服务器连接配置。
  - 当需要清除中继日志文件中的错误并重新启动复制时。

- **`RESET SLAVE ALL`**：
  - 当从服务器需要完全重置，包括清除所有连接和位置信息时。
  - 当准备将从服务器连接到新的主服务器或需要重新配置复制环境时。

### 示例

#### 使用 `RESET SLAVE`

```sql
-- 重置从服务器复制状态，保留主服务器连接信息
RESET SLAVE;
```

#### 使用 `RESET SLAVE ALL`

```sql
-- 完全重置从服务器复制状态和主服务器连接信息
RESET SLAVE ALL;
```

### 注意事项

- 在执行 `RESET SLAVE ALL` 后，从服务器将丢失所有主服务器的连接信息，需要通过 `CHANGE MASTER TO` 命令重新配置主服务器连接。
- 执行这些命令前，应确保对从服务器的数据有完整的备份，以防止数据丢失或同步中断。
- 在多线程复制（MySQL 5.6及以上版本）中，特别注意 `RESET SLAVE ALL` 的使用，因为它会完全重置复制环境。

总结来说，`RESET SLAVE` 和 `RESET SLAVE ALL` 提供了不同的功能以帮助管理员根据具体需求管理从服务器的复制状态和连接信息。在实际操作中，选择合适的命令可以确保复制环境的稳定和一致性。