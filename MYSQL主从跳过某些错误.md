# MYSQL主从跳过某些错误
**此方法在某些错误下 会造成主从数据不一致的情况，建议谨慎执行，充分了解后再使用**
## 解决办法一：跳过错误(少数错误推荐)  
1. 停止slave进程
2. 设置事务号，`select  * from performance_schema.replication_applier_status_by_worker\G;`，找到这个报错的GTID ,即跳过这个GTID
3. 执行空事物
4. 恢复自动事物号
5. 启动slave进程 
6. 查看主从复制情况

```sql
mysql>stop slave sql_thread;
mysql>set @@session.gtid_next='891da11e-d6ac-11ec-8188-ecc01b8a67c0:461777343';
mysql>begin;commit;
mysql>select @@session.gtid_next;
mysql>set @@session.gtid_next=automatic;
mysql>select @@session.gtid_next;
mysql>start slave sql_thread;
mysql>SHOW SLAVE STATUS \G;
mysql>select  * from performance_schema.replication_applier_status_by_worker\G;
```
## 解决办法二：
重置master方法跳过错误(不推荐，因为需要执行reset master;如果其他节点记录有该实例的位点信息的话，切换时需要重新找位点）  

```sql
mysql> STOP SLAVE;
mysql> RESET MASTER;
mysql> SET @@GLOBAL.GTID_PURGED ='8f9e146f-0a18-11e7-810a-0050568833c8:1-4';
mysql> START SLAVE;  
```
上面这些命令的用意是，忽略8f9e146f-0a18-11e7-810a-0050568833c8:1-4 这个GTID事务，下一次事务接着从 5 这个GTID开始，即可跳过上述错误。  

## 解决办法三：
使用pt-slave-restart工具，忽略特定错误，（冲突较多时可以使用，建议保留relaylog核对事务），  

pt-slave-restart工具的作用是监视某些特定的复制错误，然后忽略，并且再次启动SLAVE进程（Watch and restart MySQL replication after errors）。

```sql
pt-slave-restart h=192.168.0.1,P=3306,u=root,p='xxxxxx --skip-count=100  --error-numbers=1062,1032
```
## 列举 一些 常见的MYSQL常见错误类型
|错误编号|错误描述|
| ----- | ----- |
|1005|创建表失败|
|1006|创建数据库失败|
|1007|数据库已存在，创建数据库失败|
|1008|数据库不存在，删除数据库失败|
|1009|不能删除数据库文件导致删除数据库失败|
|1010|不能删除数据目录导致删除数据库失败|
|1011|删除数据库文件失败|
|1012|不能读取系统表中的记录|
|1020|记录已被其他用户修改|
|1021|硬盘剩余空间不足，请加大硬盘可用空间|
|1022|关键字重复，更改记录失败|
|1023|关闭时发生错误|
|1024|读文件错误|
|1025|更改名字时发生错误|
|1026|写文件错误|
|1032|记录不存在|
|1036|数据表是只读的，不能对它进行修改|
|1037|系统内存不足，请重启数据库或重启服务器|
|1038|用于排序的内存不足，请增大排序缓冲区|
|1040|已到达数据库的最大连接数，请加大数据库可用连接数|
|1041|系统内存不足|
|1042|无效的主机名|
|1043|无效连接|
|1044|当前用户没有访问数据库的权限|
|1045|不能连接数据库，用户名或密码错误|
|1048|字段不能为空|
|1049|数据库不存在|
|1050|数据表已存在|
|1051|数据表不存在|
|1054|字段不存在|
|1065|无效的SQL语句，SQL语句为空|
|1081|不能建立Socket连接|
|1114|数据表已满，不能容纳任何记录|
|1116|打开的数据表太多|
|1129|数据库出现异常，请重启数据库|
|1130|连接数据库失败，没有连接数据库的权限|
|1133|数据库用户不存在|
|1141|当前用户无权访问数据库|
|1142|当前用户无权访问数据表|
|1143|当前用户无权访问数据表中的字段|
|1146|数据表不存在|
|1147|未定义用户对数据表的访问权限|
|1149|SQL语句语法错误|
|1158|网络错误，出现读错误，请检查网络连接状况|
|1159|网络错误，读超时，请检查网络连接状况|
|1160|网络错误，出现写错误，请检查网络连接状况|
|1161|网络错误，写超时，请检查网络连接状况|
|1062|字段值重复，入库失败|
|1169|字段值重复，更新记录失败|
|1177|打开数据表失败|
|1180|提交事务失败|
|1181|回滚事务失败|
|1203|当前用户和数据库建立的连接已到达数据库的最大连接数，请增大可用的数据库连接数或重启数据库|
|1205|加锁超时|
|1211|当前用户没有创建用户的权限|
|1216|外键约束检查失败，更新子表记录失败|
|1217|外键约束检查失败，删除或修改主表记录失败|
|1226|当前用户使用的资源已超过所允许的资源，请重启数据库或重启服务器|
|1227|权限不足，您无权进行此操作|
|1235|MySQL版本过低，不具有本功能|

